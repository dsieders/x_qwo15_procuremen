<?xml version="1.0" encoding="UTF-8"?><record_update sys_domain="global" table="sysevent_in_email_action">
    <sysevent_in_email_action action="INSERT_OR_UPDATE">
        <action>record_action</action>
        <active>true</active>
        <assignment_operator/>
        <condition_script/>
        <description>This inbound email action is triggered when an email is sent to this instance, to a mailbox starting with x_qwo15_procuremen or with the subject starting with Procurement and the email is not a reply or forward.&#13;
&#13;
This inbound email action can create a new Procurement Request, setting the opened by, caller, short description, description, contact type. The original email will be stored in the work notes. &#13;
&#13;
In addition to being able to explicitly set the values of the above fields within the email, the following is done automatically:&#13;
&#13;
1. The caller is set to the the user who sent the email.&#13;
2. The email subject is set as the short description.&#13;
3. The whole email is added to the work notes.&#13;
4. The contact type is set to "email".&#13;
&#13;
Example: &#13;
This email will create a new Procurement Request for Fred Luddy &#13;
&#13;
From: 	Fred Luddy &lt;fred.luddy@example.com&gt;&#13;
Subject: 	Procurement:I need assistance&#13;
Date: 	June 11, 2013 1:44:55 PM PDT&#13;
To: 	        ServiceNow&#13;
&#13;
Please provide me with a ..... &#13;
&#13;
-----</description>
        <event_name>email.read</event_name>
        <filter_condition table="sys_email">recipientsLIKEprocurementreports@goldcoast.qld.gov.au^EQ<item endquery="false" field="recipients" goto="false" newquery="false" operator="LIKE" or="false" value="procurementreports@goldcoast.qld.gov.au"/>
            <item endquery="true" field="" goto="false" newquery="false" operator="=" or="false" value=""/>
        </filter_condition>
        <from/>
        <name>(CoGC) Create Procurement Rpt Req (Fwd)</name>
        <order>80</order>
        <reply_email/>
        <required_roles/>
        <script><![CDATA[current.sys_class_name = 'Procurement Request';
      //current.x_qwo15_procuremen_requested_for = 'Belinda Donovan'
      //current.description = 'Belinda Donovan'
      current.insert();
      var newRec = current.sys_id;

      var gr = new GlideRecord('sys_email');
      gr.addQuery('uid', email.uid);
      gr.query();

      var attid = '';
      if (gr.next())
        attid = gr.sys_id;

      var gra = GlideRecord('sys_attachment');
      gra.addQuery('table_sys_id', attid);
      gra.addQuery('table_name', 'sys_email');
      gra.query();

      while (gra.next())
      {
        gra.current.sys_class_name = 'Procurement Request';
        gra.table_sys_id = newRec;
        gra.update();
      }
            current.update();
            
]]></script>
        <stop_processing>false</stop_processing>
        <sys_class_name>sysevent_in_email_action</sys_class_name>
        <sys_created_by>Peter</sys_created_by>
        <sys_created_on>2016-06-21 04:41:50</sys_created_on>
        <sys_customer_update>false</sys_customer_update>
        <sys_domain>global</sys_domain>
        <sys_domain_path>/</sys_domain_path>
        <sys_id>7c0916c74fc02280e5724c111310c7b5</sys_id>
        <sys_mod_count>6</sys_mod_count>
        <sys_name>(CoGC) Create Procurement Rpt Req (Fwd)</sys_name>
        <sys_overrides/>
        <sys_package display_value="Procurement" source="x_qwo15_procuremen">1279fc654f84ae40e5724c111310c775</sys_package>
        <sys_policy/>
        <sys_replace_on_upgrade>false</sys_replace_on_upgrade>
        <sys_scope display_value="Procurement">1279fc654f84ae40e5724c111310c775</sys_scope>
        <sys_update_name>sysevent_in_email_action_7c0916c74fc02280e5724c111310c7b5</sys_update_name>
        <sys_updated_by>Mike</sys_updated_by>
        <sys_updated_on>2016-07-18 12:13:44</sys_updated_on>
        <table>x_qwo15_procurement_request</table>
        <template>assignment_group=ce466da24f64e6802d434c111310c774^callerDYNAMIC2fd8e97bef3221002841f7f775c0fbc1^short_descriptionDYNAMICb637bd21ef3221002841f7f775c0fbb6^descriptionDYNAMIC367bf121ef3221002841f7f775c0fbe2^state=1^x_qwo15_procuremen_medium=Email^EQ</template>
        <type>forward</type>
    </sysevent_in_email_action>
</record_update>
